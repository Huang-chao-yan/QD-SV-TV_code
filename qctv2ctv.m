
function F = qctv2ctv(I,mu)

A = [2+3*mu,-1,-1;-1,2+3*mu,-1;-1,-1,2+3*mu];


[P,D] = eig(A); %P^(-1)*D*P=A;

PT = P';

PT = [1/sqrt(2) -1/sqrt(2) 0;
     1/sqrt(6) 1/sqrt(6) -2/sqrt(6);
     1/sqrt(3) 1/sqrt(3) 1/sqrt(3)];

% if s==2 %mu = 0
%  PT = [0.5774    0.7634    0.2895;
%      0.5774   -0.6325    0.5164;
%      0.5774   -0.1310   -0.8059]';
% elseif s == 3 %with standrization
%   P =[-0.5774    0.2673    0.7715
%    -0.5774   -0.8018   -0.1543
%    -0.5774    0.5345   -0.6172];
% Dinv = diag([1,sqrt(2),sqrt(2)]);
% PT = Dinv*P';
% else
%     %mu = 1
% %    PT =[-0.5774    0.2673    0.7715
% %    -0.5774   -0.8018   -0.1543
% %    -0.5774    0.5345   -0.6172]'; 
% %(Ur+Ug+Ub)^2
% PT = [-0.5774   -0.2136    0.7881
%    -0.5774    0.7893   -0.2091
%    -0.5774   -0.5757   -0.5790]';
% 
% end

F(:,:,1) = PT(1,1)*I(:,:,1)+PT(1,2)*I(:,:,2)+PT(1,3)*I(:,:,3);
F(:,:,2) = PT(2,1)*I(:,:,1)+PT(2,2)*I(:,:,2)+PT(2,3)*I(:,:,3);
F(:,:,3) = PT(3,1)*I(:,:,1)+PT(3,2)*I(:,:,2)+PT(3,3)*I(:,:,3);


