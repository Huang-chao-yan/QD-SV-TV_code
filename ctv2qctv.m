
function I = ctv2qctv(F,mu)

A = [2+3*mu,-1,-1;-1,2+3*mu,-1;-1,-1,2+3*mu];


[P,D] = eig(A);

PT = [1/sqrt(2) -1/sqrt(2) 0;
     1/sqrt(6) 1/sqrt(6) -2/sqrt(6);
     1/sqrt(3) 1/sqrt(3) 1/sqrt(3)];
 
 P = PT';

% if s==2
%  P = [0.5774    0.7634    0.2895;
%      0.5774   -0.6325    0.5164;
%      0.5774   -0.1310   -0.8059];
% elseif s == 3
%  P =[-0.5774    0.2673    0.7715
%    -0.5774   -0.8018   -0.1543
%    -0.5774    0.5345   -0.6172];
% D = diag([1,1/sqrt(2),1/sqrt(2)]);
% P = P*D;
% else
% % P =[-0.5774    0.2673    0.7715
% %    -0.5774   -0.8018   -0.1543
% %    -0.5774    0.5345   -0.6172];
% 
% P = [-0.5774   -0.2136    0.7881
%    -0.5774    0.7893   -0.2091
%    -0.5774   -0.5757   -0.5790];
% 
% end

I(:,:,1) = P(1,1)*F(:,:,1)+P(1,2)*F(:,:,2)+P(1,3)*F(:,:,3);
I(:,:,2) = P(2,1)*F(:,:,1)+P(2,2)*F(:,:,2)+P(2,3)*F(:,:,3);
I(:,:,3) = P(3,1)*F(:,:,1)+P(3,2)*F(:,:,2)+P(3,3)*F(:,:,3);

